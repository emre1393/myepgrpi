**------------------------------------------------------------------------------------------------
* @header_start
* WebGrab+Plus ini for grabbing EPG data from TvGuide websites
* @Site: m.tvtoday.de
* @MinSWversion:  V1.56.29
* @Revision 3 - [03/04/2017] Netuddki
*   - added option for onscreen OR xmltv_ns episode system
*   - removed episode from description
* @Revision 2 - [24/02/2017] Netuddki
*   - added show icons
* @Revision 1 - [17/02/2017] Christoph21x
*	- Bug Correction: wrong episode name, if it contais a comma
*	- Bug Correction: Added additional support for episode text format "Staffel ss, Folge ee/nn" (+60% recognition)
*	- Bug correction: Show title was erased from subtitle, even if it's part of it
*	- Compatibility: MinSWversion lowered to actually working version
*	- Added Season / Episode info into description to select individual seasons in rec. schedules (Argus TV, Guide Enricher user)
* @Revision 0 - [01/11/2016] Netuddki
*   - creation
* @Remarks:
* @header_end
**------------------------------------------------------------------------------------------------

site {url=tvtoday.de.m|timezone=Europe/Berlin|maxdays=14|cultureinfo=de-DE|charset=UTF-8|titlematchfactor=90}
site {ratingsystem=DE|nopageoverlaps}
*
*site {episodesystem=onscreen|} *Enable for Onscreen Episode System
site {episodesystem=xmltv_ns|} *Enable for xmltv_ns Episode System
*
url_index{url|http://m.tvtoday.de/sender/|channel|.html?date=|urldate|}
url_index.headers {customheader=Accept-Encoding=gzip,deflate}
*
urldate.format {datestring|yyyy-MM-dd}
index_showsplit.scrub {multi|<div class="cell listing-text">|||</li>}
*
index_date.scrub {single|}
index_start.scrub {single| <span class="t">||</span>|</span>}
index_title.scrub {single|<h2>||</h2>|</h2>} 
*
index_urlshow {url|http://m.tvtoday.de|<a href="||"|"}
index_urlshow.headers {customheader=Accept-Encoding=gzip,deflate}
*
title.scrub {single|<h1>||</h1>|</h1>}
showicon.scrub {single|<div class="media">|src="|" width|</div>}
subtitle.scrub {regex||<span class="genre">.*?,\s([^\d]*),\s*Staffel||}  
titleoriginal.scrub {single|<dt>Originaltitel:</dt>|<dd>|</dd>|<dt>}
description.scrub {single|<div class="description-text">|<p>|</p>|</div>} 
director.scrub {single(separator="; ")|<dt>Regie:</dt>|<dd>|</dd>|<dt>}
actor.scrub {single(separator=", ")|movie-info-cast clear">|<dd class="full">|</dd>|</dl>}
rating.scrub {single|<div class="br-date-info">|">|</div>|</div>}
category.scrub {single|<dt>Genre:</dt>|<dd>|</dd>|<dt>}
productiondate.scrub {single|<dt>Jahr:</dt>|<dd>|</dd>|<dt>}
country.scrub {single|<dt>Land:</dt>|<dd>|</dd>|</dt>}
*
* titleoriginal.modify {clear('title')}
description.modify {remove| (Senderinfo)}
description.modify {cleanup}
description.modify {addstart("")|Keine Details verf√ºgbar.}
rating.modify {clear(not~ "Jahren")}

* Scrub season / episode info
episode.scrub {regex(pattern="Staffel 'S1', Folge 'E1'")||<span class="genre">.*?(Staffel \d+, Folge \d+)[,/]||}

**  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _
**      #####  CHANNEL FILE CREATION (only to create the xxx-channel.xml file)
**
** @auto_xml_channel_start
*url_index{url|http://m.tvtoday.de/sender-abc/}
*index_site_id.scrub {multi|id="channelList"|<a href="/sender/|.html"|</ul>}
*index_site_channel.scrub {multi|<img src="|</img>|</a>|}
*scope.range {(channellist)|end}
*index_site_id.modify {cleanup(removeduplicates=equal,100 link="index_site_channel")}
end_scope
** @auto_xml_channel_end
